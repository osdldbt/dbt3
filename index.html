<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<title>Database Test 3 (DBT-3) User's Guide</title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 9079 2022-06-19 14:00:56Z milde $                                                               */
/* :Copyright: © 2015, 2021 Günter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.2em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* …, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
/* inline images */
p img, p video, figure img, figure video {
  display: inline;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 9081 2022-06-19 20:23:12Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
  --field-indent: 9em; /* default indent of fields in field lists */
}
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
div.line-block,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes and Topics */
bockquote { margin: 1em 2em; }
blockquote p.attribution,
.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
.footnote-list {
  border-left: solid thin;
  padding-left: 0.25em;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
video.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
video.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
  margin-left: 1em;
  margin-right: -1%;
  background-color: #fffffa;
}


/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* https://docutils.sourceforge.io/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math */
/* for math-output=MathML (for math-output=HTML, see math.css) */
math .boldsymbol {
  font-weight: bold;
}
mstyle.mathscr, mi.mathscr {
  font-family: STIX;
}

/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a[role="doc-noteref"] */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body class="with-toc">
<main id="database-test-3-dbt-3-user-s-guide">
<h1 class="title">Database Test 3 (DBT-3) User's Guide</h1>

<img alt="OSDL Logo" src="osdl-logo.png" style="width: 600px;" />
<p>Copyright (c) 2002 by The Open Source Development Laboratory, Inc. This
material may be distributed only subject to the terms and conditions set forth
in the Open Publication License, v1.0 or later (the latest version is currently
available at <a class="reference external" href="http://www.opencontent.org/openpub/">http://www.opencontent.org/openpub/</a>). Distribution of
substantively modified versions of this document is prohibited without the
explicit permission of the copyright holder.</p>
<p>Other company, product or service names may be trademarks or service marks of
others.</p>
<p>Contributors to this document include:</p>
<ul class="simple">
<li><p>Jenny Zhang (OSDL)</p></li>
<li><p>Mary Edie Meredith (OSDL)</p></li>
<li><p>Mark Wong (OSDL)</p></li>
</ul>
<nav class="contents" id="table-of-contents" role="doc-toc">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="toc-entry-1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#installing-dbt-3" id="toc-entry-2">Installing DBT-3</a></p>
<ul>
<li><p><a class="reference internal" href="#required-software" id="toc-entry-3">Required Software</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#user-s-guide" id="toc-entry-4">User's Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#building-tpc-h-tools" id="toc-entry-5">Building TPC-H Tools</a></p>
<ul>
<li><p><a class="reference internal" href="#quick-start" id="toc-entry-6">Quick Start</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#advanced-notes" id="toc-entry-7">Advanced Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-dbt-3-environment-variables" id="toc-entry-8">Setting DBT-3 Environment Variables</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#workload-notes" id="toc-entry-9">Workload Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#sizing-the-system" id="toc-entry-10">Sizing the System</a></p></li>
<li><p><a class="reference internal" href="#qgen" id="toc-entry-11">QGEN</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#database-management-system-specific-notes" id="toc-entry-12">Database Management System Specific Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#monetdb" id="toc-entry-13">MonetDB</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables" id="toc-entry-14">Environment Variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mysql-mariadb" id="toc-entry-15">MySQL/MariaDB</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables-1" id="toc-entry-16">Environment Variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#postgresql" id="toc-entry-17">PostgreSQL</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables-2" id="toc-entry-18">Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#query-execution-plans" id="toc-entry-19">Query Execution Plans</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#postgres-xl" id="toc-entry-20">Postgres-XL</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables-3" id="toc-entry-21">Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#postgres-xl-architecture" id="toc-entry-22">Postgres-XL Architecture</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#virtuoso" id="toc-entry-23">Virtuoso</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables-4" id="toc-entry-24">Environment Variables</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#results" id="toc-entry-25">Results</a></p></li>
<li><p><a class="reference internal" href="#developer-s-guide" id="toc-entry-26">Developer's Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#query-templates" id="toc-entry-27">Query Templates</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">Introduction</a></h2>
<p>This document provides instructions on how to set up and use the Open Source
Development Lab's Database Test 3 (DBT-3) kit.  This kit provides what is
needed to execute a workload similar to the TPC-H workload.</p>
</section>
<section id="installing-dbt-3">
<h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">Installing DBT-3</a></h2>
<p>The latest stable and development version of the kit can be found on GitHub:
<a class="reference external" href="https://github.com/osdldbt/dbt3">https://github.com/osdldbt/dbt3</a></p>
<p>The TPC's TPC-H Tools cannot be redistributed with DBT-3 and must be downloaded
by the tester:
<a class="reference external" href="https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp">https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp</a></p>
<section id="required-software">
<h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">Required Software</a></h3>
<p>In addition to the database management system software, the following is also
required:</p>
<ul class="simple">
<li><p>bc</p></li>
<li><p>SQLite <a class="reference external" href="https://www.sqlite.org/index.html">https://www.sqlite.org/index.html</a></p></li>
<li><p><strong>sar</strong>, <strong>pidstat</strong> <a class="reference external" href="http://pagesperso-orange.fr/sebastien.godard/">http://pagesperso-orange.fr/sebastien.godard/</a> (While the
scripts assume this particular version of <strong>sar</strong> and <strong>pidstat</strong>, it is
possible to run on non-Linux based operating systems with some modifications
to the kit.)</p></li>
</ul>
</section>
</section>
<section id="user-s-guide">
<h2><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">User's Guide</a></h2>
<section id="building-tpc-h-tools">
<h3><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">Building TPC-H Tools</a></h3>
<p>The kit requires the TPC-H Tools to be built for the specific database
management system to be tested.  The TPC-H Tools is developed in such a way
that it needs to rebuilt or another copy needs to be built if a different
database management system is to be tested.</p>
<p>DBT-3 provides a script to apply patches and compile the TPC-H Tools.  The
patches that are applied are minor code changes and query templates to make the
TPC-H Tools work with the databases supposed by DBT-3.</p>
<p>For example, to build the TPC-H Tools for PostgreSQL (pgsql), unzip the TPC-H
Tools zip file and run <cite>dbt3-build-dbgen</cite> against the resulting directory:</p>
<pre class="literal-block">unzip *-tpc-h-tool.zip
dbt3-build-dbgen pgsql &quot;TPC-H V3.0.1&quot;/</pre>
<section id="quick-start">
<h4><a class="toc-backref" href="#toc-entry-6" role="doc-backlink">Quick Start</a></h4>
<p>Once the TPC-H Tools is built, only one command needs to be issued to run a
complete test:</p>
<pre class="literal-block">dbt3-run --tpchtools=&quot;TPC-H V3.0.1&quot; pgsql /tmp/results</pre>
<p>This will run the generate the data files for a 1 GB scale factor database
load, power and throughput test, with 2 streams, against PostgreSQL and save
the results of the test in <cite>/tmp/results</cite>.</p>
<p>The <em>dbt3-run</em> script can be used to run any combination of a load test, power
test, and throughput test.  A load tests must be run in order to create the
database before a power or throughput tests can be run individually.</p>
</section>
</section>
<section id="advanced-notes">
<h3><a class="toc-backref" href="#toc-entry-7" role="doc-backlink">Advanced Notes</a></h3>
<section id="setting-dbt-3-environment-variables">
<h4><a class="toc-backref" href="#toc-entry-8" role="doc-backlink">Setting DBT-3 Environment Variables</a></h4>
<p><strong>dbgen</strong>, <strong>qgen</strong> require specific environment variables to be set in order
to function properly.  The following environment variables are required to be
set if run manually, otherwise the <em>dbt3-run</em> script will set the variables
based on the given command line arguments:</p>
<ul class="simple">
<li><p><cite>DSS_PATH=/tmp/dss</cite> - Absolute path in which to build flat files.</p></li>
<li><p><cite>DSS_QUERY=${TPCHTOOLS}/dbgen/queries</cite> - Absolute path in which to find query
templates.</p></li>
<li><p><cite>DSS_CONFIG=${TPCHTOOLS}/dbgen</cite> - Directory in which to find <strong>dbgen</strong>
configuration files.</p></li>
</ul>
<p>Testers can choose to run all the tests in DBT-3 as well as part of the tests.
The following section describes how to run all the tests.</p>
<p>Tester may also create several databases so that several scale factors can be
tested or various implementation strategies compared.  They will only need to
change environment variables to point to the correct database prior to
executing the test kit scripts.</p>
<p>Each DBMS may have additional environment variables that may need to be set.
See the database management system specific section for details.</p>
</section>
</section>
</section>
<section id="workload-notes">
<h2><a class="toc-backref" href="#toc-entry-9" role="doc-backlink">Workload Notes</a></h2>
<section id="sizing-the-system">
<h3><a class="toc-backref" href="#toc-entry-10" role="doc-backlink">Sizing the System</a></h3>
<p>The scale factor can actually be any decimal number (like 1.1 or 50) so that
if the tester wishes, the tester can create a database whose size is not one
of the officially permitted scale factors.  This might be desirable for
development purposes.  Any results should be advertised with the scale factor
used, since the performance varies based on the amount of data required for
processing the queries.  The database size is defined with reference to scale
factor.  For example, for scale factor 1, the raw data files' total size is
roughly 1 GB.</p>
<p>Note:  This kit does not support scale factors less than 1.  Although you can
build a database using scale factors less than 1, the query generator
(<strong>qgen</strong>) will not generate the proper variable values that correspond to
scale factors less than 1.</p>
<p>The tester needs to allocate space for the flat files generated by <strong>dbgen</strong>
used to load the database.  Once the database is loaded and backed up, there is
no need to retain these flat files.</p>
</section>
<section id="qgen">
<h3><a class="toc-backref" href="#toc-entry-11" role="doc-backlink">QGEN</a></h3>
<p>The <cite>qgen</cite> program can be manually run to inspect the SQL statement to that
will be executed by the test.</p>
<p>For example (see <cite>qgen -h</cite> for option descriptions) to see what the first
query to be executed:</p>
<pre class="literal-block">qgen -c -r 0 -p 0 -s 1 5</pre>
<p>Results in the following query for PostgreSQL:</p>
<pre class="literal-block">-- using 0 as a seed to the RNG
-- &#64;(#)14.sql       2.1.8.1
-- TPC-H/TPC-R Promotion Effect Query (Q14)
-- Functional Query Definition
-- Approved February 1998
BEGIN;



select
       100.00 * sum(case
               when p_type like 'PROMO%'
                       then l_extendedprice * (1 - l_discount)
               else 0
       end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
       lineitem,
       part
where
       l_partkey = p_partkey
       and l_shipdate &gt;= date '1993-01-01'
       and l_shipdate &lt; cast(date '1993-01-01' + interval '1 month' as date);
COMMIT;</pre>
</section>
</section>
<section id="database-management-system-specific-notes">
<h2><a class="toc-backref" href="#toc-entry-12" role="doc-backlink">Database Management System Specific Notes</a></h2>
<section id="monetdb">
<h3><a class="toc-backref" href="#toc-entry-13" role="doc-backlink">MonetDB</a></h3>
<section id="environment-variables">
<h4><a class="toc-backref" href="#toc-entry-14" role="doc-backlink">Environment Variables</a></h4>
<ul class="simple">
<li><p><cite>DBDATA=/tmp/monetdb</cite> - This defines where to initialize the MonetDB data
directory</p></li>
<li><p><cite>DBNAME=dbt3</cite> - This is the database name to use.</p></li>
</ul>
</section>
</section>
<section id="mysql-mariadb">
<h3><a class="toc-backref" href="#toc-entry-15" role="doc-backlink">MySQL/MariaDB</a></h3>
<p>When using <strong>mysqladmin</strong> to start the database, options will be loaded from one
of these locations, if they exist: <cite>/etc/my.cnf</cite>, <cite>/etc/mysql/my.cnf</cite>, or
<cite>~/.my.cnf</cite>.  The environment variable <cite>MYSQL_HOME</cite> can also be used to
specify where a <em>my.cnf</em> file exists.</p>
<section id="environment-variables-1">
<h4><a class="toc-backref" href="#toc-entry-16" role="doc-backlink">Environment Variables</a></h4>
<ul class="simple">
<li><p><cite>DBNAME=dbt3</cite> - This is the database name to use.</p></li>
<li><p><cite>MYDATA=/tmp/mydata</cite> - This defines where to initialize the MySQL data
directory</p></li>
</ul>
</section>
</section>
<section id="postgresql">
<h3><a class="toc-backref" href="#toc-entry-17" role="doc-backlink">PostgreSQL</a></h3>
<section id="environment-variables-2">
<h4><a class="toc-backref" href="#toc-entry-18" role="doc-backlink">Environment Variables</a></h4>
<ul class="simple">
<li><p><cite>PGDATABASE=dbt3</cite> - This is the database name to use.</p></li>
<li><p><cite>PGDATA=/tmp/pgdata</cite> - This defines where the PostgreSQL instance will be
created.</p></li>
<li><p><cite>DEFAULT_LOAD_PARAMETERS=&quot;-c shared_buffers=1GB&quot;</cite> - This defines the
database parameters to be set for the load test.  The syntax is that same as
that used to set parameters from the command line as if using <strong>pg_ctl</strong>.
(e.g. &quot;-c shared_buffers=1GB&quot;)</p></li>
<li><p><cite>DEFAULT_POWER_PARAMETERS=&quot;&quot;</cite> - This defines the database parameters to set
for the power test.</p></li>
<li><p><cite>DEFAULT_THROUGHPUT_PARAMETERS=&quot;&quot;</cite> - This defines the database parameters
to be set for the throughput test.</p></li>
</ul>
</section>
<section id="query-execution-plans">
<h4><a class="toc-backref" href="#toc-entry-19" role="doc-backlink">Query Execution Plans</a></h4>
<p>There is an additional <cite>--explain</cite> flag that can be used for testing PostgreSQL
with the <em>dbt3-</em> script that will execute the queries in the power and
throughput tests using <cite>EXPLAIN (ANALYZE, BUFFERS)</cite> thus returning actual
execution plans instead of the query results.</p>
<p>If the <cite>--explain</cite> flag is used, an additional plan disaster report will be
generating showing which queries grossly misestimated the number of rows
returned at each node of the plan.</p>
</section>
</section>
<section id="postgres-xl">
<h3><a class="toc-backref" href="#toc-entry-20" role="doc-backlink">Postgres-XL</a></h3>
<section id="environment-variables-3">
<h4><a class="toc-backref" href="#toc-entry-21" role="doc-backlink">Environment Variables</a></h4>
<p>In addition to the PostgreSQL environment variables, Postgres-XL requires the
following:</p>
<ul class="simple">
<li><p><cite>GTMHOST=&quot;pgxl&quot;</cite> - Hostname for the GTM master and Coordinator node.</p></li>
<li><p><cite>HOSTNAMES=&quot;pgxl1 pgxl2&quot;</cite> - A space-delimited list of hostnames for the
Datanodes.export GTMDATA=&quot;$PGDATA/gtm&quot;</p></li>
<li><p><cite>COORDINATORDATA=&quot;$PGDATA/coordinator&quot;</cite> - Data directory for the Coordinator.</p></li>
<li><p><cite>GTMPROXYDATA=&quot;$PGDATA/gtm_proxy.&quot;</cite> - Data directory prefix for the GTM
proxy.  The node number will be automatically appended to the end.</p></li>
<li><dl class="simple">
<dt><cite>DATANODEDATA=&quot;$PGDATA/datanode.&quot;</cite> - Data directory prefix for the Datanode.</dt>
<dd><p>The node number will be automatically appended to the end.</p>
</dd>
</dl>
</li>
<li><p><cite>DNPN=2</cite> - Number of datanodes to create per system node.</p></li>
<li><p><cite>DNBP=15432</cite> - Starting listener port number for datanodes.</p></li>
<li><p><cite>DNBPP=25432</cite> - Starting listener port number for datanode pooler.</p></li>
</ul>
</section>
<section id="postgres-xl-architecture">
<h4><a class="toc-backref" href="#toc-entry-22" role="doc-backlink">Postgres-XL Architecture</a></h4>
<p>See additional notes for the base PostgreSQL version for items that also apply
to Postgres-XL.</p>
<p>A Postgres-XL cluster can be built in many different ways.  The scripts in this
kit builds them only in one specific configuration:</p>
<pre class="literal-block">                   +-------------+
                   | GTM Master  |
                   | Coordinator |
                   +-------------+
                  /       |       \
                 /        |        \
                /         |         \
               /          |          \
+-------------+    +-------------+    ...
|  GTM Proxy  |    |  GTM Proxy  |
|  Datanode   |----|  Datanode   |----
+-------------+    +-------------+</pre>
</section>
</section>
<section id="virtuoso">
<h3><a class="toc-backref" href="#toc-entry-23" role="doc-backlink">Virtuoso</a></h3>
<p>In order to keep the scripts simple, the installation of this software needs to
be the same as the user that will be executing the test kit.  The reason for
this is because the database location is tied to the parameters set when
running the Virtuoso configure script.</p>
<section id="environment-variables-4">
<h4><a class="toc-backref" href="#toc-entry-24" role="doc-backlink">Environment Variables</a></h4>
<ul class="simple">
<li><p><cite>VADDIR=/usr/local/virtuoso-opensource/var/lib/virtuoso/db</cite> - Location of
<em>virtuoso.ini</em> file.</p></li>
</ul>
</section>
</section>
</section>
<section id="results">
<h2><a class="toc-backref" href="#toc-entry-25" role="doc-backlink">Results</a></h2>
<p>The results directory created from running tests with the <em>dbt3-run</em> script
will contain the calculated metrics of the test.</p>
<p>The primary metrics will be in the <cite>score.rst</cite> file:</p>
<pre class="literal-block">       Composite Score:     3746.61
Load Test Time (hours):        1.87
      Power Test Score:     3634.28
 Throughput Test Score:     3862.43</pre>
<p>More detailed query results will be in the <cite>summary.rst</cite> file:</p>
<pre class="literal-block">Power Test
----------

* Seed: 517231038

+--------------------+------------------------+------------------------+------------------------+
| Duration (seconds) |    Query Start Time    |     RF1 Start Time     |     RF2 Start Time     |
|                    +------------------------+------------------------+------------------------+
|                    |     Query End Time     |      RF1 End Time      |      RF2 End Time      |
+====================+========================+========================+========================+
|              18.16 | 2023-05-17 23:10:43.47 | 2023-05-17 23:10:38.87 | 2023-05-17 23:10:56.98 |
|                    +------------------------+------------------------+------------------------+
|                    | 2023-05-17 23:10:56.98 | 2023-05-17 23:10:43.46 | 2023-05-17 23:10:57.02 |
+--------------------+------------------------+------------------------+------------------------+

=======  =========================
 Query    Response Time (seconds)
=======  =========================
      1                       2.20
      2                       0.34
      3                       0.51
      4                       0.17
      5                       0.54
      6                       0.36
      7                       0.61
      8                       0.23
      9                       1.33
     10                       0.67
     11                       0.16
     12                       0.62
     13                       1.61
     14                       0.38
     15                       0.72
     16                       0.31
     17                       0.02
     18                       1.93
     19                       0.03
     20                       0.13
     21                       0.33
     22                       0.08
    RF1                       4.58
    RF2                       0.04
=======  =========================

Throughput Test
---------------

Stream execution summary:

+-----------+-----------+------------------------+------------------------+------------------------+
|  Stream   | Duration  |    Query Start Time    |     RF1 Start Time     |     RF2 Start Time     |
+-----------+ (seconds) +------------------------+------------------------+------------------------+
|   Seed    |           |     Query End Time     |      RF1 End Time      |      RF2 End Time      |
+===========+===========+========================+========================+========================+
|         1 |     14.38 | 2023-05-17 23:10:57.60 | 2023-05-17 23:10:57.06 | 2023-05-17 23:11:01.42 |
+-----------+           +------------------------+------------------------+------------------------+
| 517231039 |           | 2023-05-17 23:11:11.97 | 2023-05-17 23:11:01.41 | 2023-05-17 23:11:01.46 |
+-----------+-----------+------------------------+------------------------+------------------------+
|         2 |     14.47 | 2023-05-17 23:10:57.59 | 2023-05-17 23:11:01.47 | 2023-05-17 23:11:05.74 |
+-----------+           +------------------------+------------------------+------------------------+
| 517231040 |           | 2023-05-17 23:11:12.05 | 2023-05-17 23:11:05.73 | 2023-05-17 23:11:05.78 |
+-----------+-----------+------------------------+------------------------+------------------------+

Query execution duration (seconds):

========  ========  ========  ========  ========  ========  ========  ========
 Stream      Q1        Q2        Q3        Q4        Q5        Q6        Q7
========  ========  ========  ========  ========  ========  ========  ========
       1      2.19      0.31      0.53      0.17      0.65      0.36      0.66
       2      2.16      0.49      0.51      0.17      0.57      0.36      0.62
     Min      2.16      0.49      0.51      0.17      0.57      0.36      0.62
     Max      2.16      0.49      0.51      0.17      0.57      0.36      0.62
     Avg      1.08      0.24      0.26      0.09      0.28      0.18      0.31
========  ========  ========  ========  ========  ========  ========  ========

========  ========  ========  ========  ========  ========  ========  ========
 Stream      Q8        Q9        Q10       Q11       Q12       Q13       Q14
========  ========  ========  ========  ========  ========  ========  ========
       1      0.24      1.30      0.64      0.22      0.63      2.28      0.37
       2      0.24      1.39      0.65      0.17      0.62      2.30      0.39
     Min      0.24      1.39      0.65      0.17      0.62      2.30      0.39
     Max      0.24      1.39      0.65      0.17      0.62      2.30      0.39
     Avg      0.12      0.69      0.32      0.08      0.31      1.15      0.20
========  ========  ========  ========  ========  ========  ========  ========

========  ========  ========  ========  ========  ========  ========  ========
 Stream      Q15       Q16       Q17       Q18       Q19       Q20       Q21
========  ========  ========  ========  ========  ========  ========  ========
       1      0.76      0.31      0.02      1.95      0.03      0.14      0.32
       2      0.75      0.31      0.02      1.96      0.03      0.14      0.33
     Min      0.75      0.31      0.02      1.96      0.03      0.14      0.33
     Max      0.75      0.31      0.02      1.96      0.03      0.14      0.33
     Avg      0.38      0.16      0.01      0.98      0.02      0.07      0.17
========  ========  ========  ========  ========  ========  ========  ========

========  ========  ========  ========
 Stream      Q22       RF1       RF2
========  ========  ========  ========
       1      0.08      4.35      0.04
       2      0.08      4.26      0.04
     Min      0.08      4.26      0.04
     Max      0.08      4.35      0.04
     Avg      0.04      4.30      0.04
========  ========  ========  ========</pre>
</section>
<section id="developer-s-guide">
<h2><a class="toc-backref" href="#toc-entry-26" role="doc-backlink">Developer's Guide</a></h2>
<section id="query-templates">
<h3><a class="toc-backref" href="#toc-entry-27" role="doc-backlink">Query Templates</a></h3>
<p>The TPC-H DBGEN tool kit includes the official query syntax for TPC-H queries.
The tester can substitute DBT-3 queries with TPC-H queries and alter the
syntax to fit other databases.  A set of query syntax for SAP DB, PostgreSQL,
MySQL, and MariaDB are included in the kit in the directory <cite>dbt3/queries</cite>.</p>
</section>
</section>
</main>
</body>
</html>
